@page "/"
@using Microsoft.IdentityModel.Tokens
@using BestMovies.Models.ApiModels
@using BestMovies.Services
@inject IMovieService MovieService
@inject NavigationManager NavigationManager

<MudPaper Elevation="0" Width="100%" Square Style="background-color: black">
    <MudContainer MaxWidth="MaxWidth.Large">
        <MudCarousel Class="mud-width-full"
                     Style="height: 720px"
                     ShowArrows
                     ShowBullets
                     AutoCycle
                     BulletsColor="Color.Info"
                     TData="object">
            @if (!Trending.TrendingMovies.IsNullOrEmpty())
            {
                @foreach (var movie in Trending.TrendingMovies)
                {
                    <MudCarouselItem Transition="Transition.Slide">
                        <div class="container" onclick="@(() => CarouselClickHandler(movie.Id))">
                            <img src="@($"https://image.tmdb.org/t/p/w1280{movie.BackdropPath}")" alt="backdrop"/>
                            <div class="text-block">
                                <h1>@movie.Title</h1>
                                <h3>@movie.ReleaseDate</h3>
                            </div>
                        </div>
                    </MudCarouselItem>
                }
            }
        </MudCarousel>
    </MudContainer>
</MudPaper>

@code{

    private TrendingMovieWrapper Trending { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        Trending = await MovieService.GetTrendingMoviesAsync();
    }

    private void CarouselClickHandler(int? id)
    {
        NavigationManager.NavigateTo($"/Movie/{id}");
    }
}